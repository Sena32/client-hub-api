{
    "info": {
      "name": "Client Hub API",
      "_postman_id": "c3a9b9f0-0000-0000-0000-client-hub-api",
      "description": "Collection para testar a Client Hub API (Django + DRF + JWT).",
      "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "variable": [
      {
        "key": "baseUrl",
        "value": "http://localhost:8000",
        "type": "string"
      },
      {
        "key": "username",
        "value": "testuser",
        "type": "string"
      },
      {
        "key": "password",
        "value": "Test@123456",
        "type": "string"
      },
      {
        "key": "email",
        "value": "testuser@example.com",
        "type": "string"
      },
      {
        "key": "accessToken",
        "value": "",
        "type": "string"
      },
      {
        "key": "refreshToken",
        "value": "",
        "type": "string"
      },
      {
        "key": "clientId",
        "value": "",
        "type": "string"
      }
    ],
    "item": [
      {
        "name": "Auth",
        "item": [
          {
            "name": "Register User (/register/)",
            "request": {
              "method": "POST",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": {
                "mode": "raw",
                "raw": "{\n  \"username\": \"{{username}}\",\n  \"email\": \"{{email}}\",\n  \"password\": \"{{password}}\",\n  \"password2\": \"{{password}}\"\n}"
              },
              "url": {
                "raw": "{{baseUrl}}/register/",
                "host": [
                  "{{baseUrl}}"
                ],
                "path": [
                  "register",
                  ""
                ]
              }
            },
            "response": []
          },
          {
            "name": "Obter Token JWT (/token/)",
            "request": {
              "method": "POST",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": {
                "mode": "raw",
                "raw": "{\n  \"username\": \"{{username}}\",\n  \"password\": \"{{password}}\"\n}"
              },
              "url": {
                "raw": "{{baseUrl}}/token/",
                "host": [
                  "{{baseUrl}}"
                ],
                "path": [
                  "token",
                  ""
                ]
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "exec": [
                    "pm.test(\"Status code é 200\", function () {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "let jsonData;",
                    "try {",
                    "    jsonData = pm.response.json();",
                    "} catch (e) {",
                    "    jsonData = null;",
                    "}",
                    "",
                    "if (jsonData && jsonData.access) {",
                    "    pm.collectionVariables.set(\"accessToken\", jsonData.access);",
                    "}",
                    "if (jsonData && jsonData.refresh) {",
                    "    pm.collectionVariables.set(\"refreshToken\", jsonData.refresh);",
                    "}"
                  ],
                  "type": "text/javascript"
                }
              }
            ]
          },
          {
            "name": "Refresh Token (/token/refresh)",
            "request": {
              "method": "POST",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": {
                "mode": "raw",
                "raw": "{\n  \"refresh\": \"{{refreshToken}}\"\n}"
              },
              "url": {
                "raw": "{{baseUrl}}/token/refresh",
                "host": [
                  "{{baseUrl}}"
                ],
                "path": [
                  "token",
                  "refresh"
                ]
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "exec": [
                    "pm.test(\"Status code é 200\", function () {",
                    "    pm.response.to.have.status(200);",
                    "});",
                    "",
                    "let jsonData;",
                    "try {",
                    "    jsonData = pm.response.json();",
                    "} catch (e) {",
                    "    jsonData = null;",
                    "}",
                    "",
                    "if (jsonData && jsonData.access) {",
                    "    pm.collectionVariables.set(\"accessToken\", jsonData.access);",
                    "}"
                  ],
                  "type": "text/javascript"
                }
              }
            ]
          },
          {
            "name": "Verificar Token (/token/verify)",
            "request": {
              "method": "POST",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": {
                "mode": "raw",
                "raw": "{\n  \"token\": \"{{accessToken}}\"\n}"
              },
              "url": {
                "raw": "{{baseUrl}}/token/verify",
                "host": [
                  "{{baseUrl}}"
                ],
                "path": [
                  "token",
                  "verify"
                ]
              }
            },
            "response": []
          }
        ]
      },
      {
        "name": "Clients",
        "auth": {
          "type": "bearer",
          "bearer": [
            {
              "key": "token",
              "value": "{{accessToken}}",
              "type": "string"
            }
          ]
        },
        "item": [
          {
            "name": "Listar Clientes (GET /clients/)",
            "request": {
              "method": "GET",
              "header": [],
              "url": {
                "raw": "{{baseUrl}}/clients/",
                "host": [
                  "{{baseUrl}}"
                ],
                "path": [
                  "clients",
                  ""
                ]
              }
            },
            "response": []
          },
          {
            "name": "Criar Cliente (POST /clients/)",
            "request": {
              "method": "POST",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": {
                "mode": "raw",
                "raw": "{\n  \"name\": \"João da Silva\",\n  \"phone\": \"+55 11 99999-9999\",\n  \"address\": {\n    \"address\": \"Rua Exemplo\",\n    \"number\": 123,\n    \"city\": \"São Paulo\",\n    \"state\": \"SP\",\n    \"country\": \"Brasil\",\n    \"zipCode\": 12345678\n  }\n}"
              },
              "url": {
                "raw": "{{baseUrl}}/clients/",
                "host": [
                  "{{baseUrl}}"
                ],
                "path": [
                  "clients",
                  ""
                ]
              }
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "exec": [
                    "pm.test(\"Status code é 201 ou 200\", function () {",
                    "    pm.expect(pm.response.code).to.be.oneOf([200, 201]);",
                    "});",
                    "",
                    "let jsonData;",
                    "try {",
                    "    jsonData = pm.response.json();",
                    "} catch (e) {",
                    "    jsonData = null;",
                    "}",
                    "",
                    "if (jsonData && jsonData.id) {",
                    "    pm.collectionVariables.set(\"clientId\", jsonData.id);",
                    "}"
                  ],
                  "type": "text/javascript"
                }
              }
            ]
          },
          {
            "name": "Obter Cliente por ID (GET /clients/{id}/)",
            "request": {
              "method": "GET",
              "header": [],
              "url": {
                "raw": "{{baseUrl}}/clients/{{clientId}}/",
                "host": [
                  "{{baseUrl}}"
                ],
                "path": [
                  "clients",
                  "{{clientId}}",
                  ""
                ]
              }
            },
            "response": []
          },
          {
            "name": "Atualizar Cliente (PUT /clients/{id}/)",
            "request": {
              "method": "PUT",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "body": {
                "mode": "raw",
                "raw": "{\n  \"id\": \"{{clientId}}\",\n  \"name\": \"João da Silva Atualizado\",\n  \"phone\": \"+55 11 98888-8888\",\n  \"address\": {\n    \"id\": \"{{addressId}}\",\n    \"address\": \"Rua Atualizada\",\n    \"number\": 456,\n    \"city\": \"São Paulo\",\n    \"state\": \"SP\",\n    \"country\": \"Brasil\",\n    \"zipCode\": 87654321\n  }\n}"
              },
              "url": {
                "raw": "{{baseUrl}}/clients/{{clientId}}/",
                "host": [
                  "{{baseUrl}}"
                ],
                "path": [
                  "clients",
                  "{{clientId}}",
                  ""
                ]
              }
            },
            "response": []
          },
          {
            "name": "Deletar Cliente (DELETE /clients/{id}/)",
            "request": {
              "method": "DELETE",
              "header": [],
              "url": {
                "raw": "{{baseUrl}}/clients/{{clientId}}/",
                "host": [
                  "{{baseUrl}}"
                ],
                "path": [
                  "clients",
                  "{{clientId}}",
                  ""
                ]
              }
            },
            "response": []
          }
        ]
      }
    ]
  }